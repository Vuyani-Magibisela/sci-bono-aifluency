<!DOCTYPE html>
<html>
<head>
    <title>Clear Cache</title>
    <style>
        body { font-family: monospace; padding: 40px; background: #1a1a1a; color: #0f0; }
        button { background: #0f0; color: #000; padding: 15px 30px; font-size: 18px; cursor: pointer; border: none; margin: 10px; }
        #status { margin-top: 20px; padding: 20px; background: #000; }
    </style>
</head>
<body>
    <h1>Cache Clearing Tool</h1>
    <button onclick="clearAllCaches()">Clear All Caches</button>
    <button onclick="unregisterServiceWorker()">Unregister Service Worker</button>
    <button onclick="clearLocalStorage()">Clear Local Storage</button>
    <button onclick="doAll()">DO ALL + RELOAD</button>

    <div id="status"></div>

    <script>
        const status = document.getElementById('status');

        function log(msg) {
            status.innerHTML += `<div>${new Date().toLocaleTimeString()}: ${msg}</div>`;
        }

        async function clearAllCaches() {
            log('Clearing all caches...');
            const cacheNames = await caches.keys();
            await Promise.all(cacheNames.map(name => caches.delete(name)));
            log(`✓ Deleted ${cacheNames.length} caches: ${cacheNames.join(', ')}`);
        }

        async function unregisterServiceWorker() {
            log('Unregistering service workers...');
            const registrations = await navigator.serviceWorker.getRegistrations();
            await Promise.all(registrations.map(reg => reg.unregister()));
            log(`✓ Unregistered ${registrations.length} service workers`);
        }

        function clearLocalStorage() {
            log('Clearing localStorage...');
            const itemCount = localStorage.length;
            localStorage.clear();
            log(`✓ Cleared ${itemCount} localStorage items`);
        }

        async function doAll() {
            await clearAllCaches();
            await unregisterServiceWorker();
            clearLocalStorage();
            log('✓ ALL DONE! Reloading in 2 seconds...');
            setTimeout(() => {
                window.location.href = 'login.html';
            }, 2000);
        }
    </script>
</body>
</html>
